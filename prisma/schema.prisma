// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema
generator client {
  // Corresponds to the cargo alias created earlier
  provider = "target/release/prisma_cli"
  // The location to generate the client. Is relative to the position of the schema
  output   = "../src/db/prisma.rs"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id         BigInt   @id @default(autoincrement())
  name       String
  username   String
  avatar_url String
  plugins    Plugin[]
}

model Plugin {
  name         String    @id
  description  String
  display_name String
  author       String
  publisher    User      @relation(fields: [publisherId], references: [id])
  publisherId  BigInt
  versions     Version[]
}

model Version {
  version    String
  plugin     Plugin  @relation(fields: [pluginName], references: [name])
  pluginName String
  yanked     Boolean
  digest     String
  preview    Boolean

  @@unique([version, pluginName])
}
